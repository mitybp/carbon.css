var __isNavigating=!1,componentCache=[];window.$insecureEval=eval,window.Planifolia={},window.PlanifoliaSettings={onNavigating:()=>{},onNavigated:()=>{},onFetch:()=>{},handleFileResolve:i=>i,basePath:"/view/",delayNavigation:0,container:null,autoRewriteLinks:!0},window.Planifolia.contentTo=(i,n)=>{window.PlanifoliaSettings.onNavigating(),window.PlanifoliaSettings.onFetch(n),__isNavigating=!0;var e=window.Planifolia.resolveFile(n);fetch(e).then((i=>i.text())).then((n=>{i.innerHTML=n,window.Planifolia.fetchComponents(i),window.Planifolia.fetchElements(i)}))},window.Planifolia.fetchTo=(i,n)=>{window.PlanifoliaSettings.onNavigating(),window.PlanifoliaSettings.onFetch(n),__isNavigating=!0;var e=window.Planifolia.resolveFile(n);fetch(e).then((i=>i.text())).then((n=>{let e=Planifolia.replaceElementBy(i,n);window.Planifolia.fetchComponents(e),window.Planifolia.fetchElements(e)}))},window.Planifolia.initializeAutoRouter=()=>{window.addEventListener("hashchange",(function(){window.Planifolia.routerFetchPage()})),window.Planifolia.routerFetchPage()},window.Planifolia.routerFetchPage=()=>{if(null==window.PlanifoliaSettings.container)throw"Please, define the window.PlanifoliaSettings.container before running the router!";var i=window.location.hash.replace("#/","");if(window.path="/"+i.replace(/^\//,""),window.pathAndQuery=window.path,""==i&&(i="index",window.location.href="#/"),i.includes("?")){let n=i.substring(i.indexOf("?"));window.query=window.Planifolia.parseQuery(n),i=i.substring(0,i.indexOf("?")),window.path=window.path.substring(0,window.path.indexOf("?")),""==i&&(i="index")}else window.query={};var n=window.Planifolia.resolveFile(i);window.locationFile=n,window.PlanifoliaSettings.onNavigating(),__isNavigating=!0;let e=window.PlanifoliaSettings.delayNavigation;setTimeout((()=>{fetch(n).then((i=>i.text())).then((i=>{window.PlanifoliaSettings.container.innerHTML=i,window.Planifolia.fetchComponents(window.PlanifoliaSettings.container),window.Planifolia.fetchElements(window.PlanifoliaSettings.container)}))}),e)},window.Planifolia.fetchComponents=i=>{var n=i.querySelectorAll("include");if(0==n.length)return window.PlanifoliaSettings.onNavigated(),void(__isNavigating=!1);n.forEach((async i=>{let n=i.getAttribute("name"),e=window.Planifolia.resolveFile(n),t="";null==componentCache[e]?(t=await fetch(e).then((i=>{if(i.ok)return i.text();throw new Error(`Cannot fetch include ${n}.`)})),componentCache[e]=t):t=componentCache[e];for(const n of i.attributes){let i=n.name,e=n.value;if(!i.startsWith("@"))continue;i=i.substr(1);const o=new RegExp("(?<!@)@"+i+"\\b","gi");t=t.replace(o,e)}let o=document.createElement(null);o.innerHTML=t,o=o.firstChild,i.replaceWith(o),window.Planifolia.fetchElements(o),window.Planifolia.fetchComponents(o)}))},window.Planifolia.fetchElements=i=>{i.querySelectorAll("script").forEach((i=>{i.remove();try{window.$insecureEval(i.innerText)}catch(i){throw i}})),window.PlanifoliaSettings.autoRewriteLinks&&i.querySelectorAll("a").forEach((i=>{let n=i.getAttribute("href");null!=n&&n.startsWith("/")&&!n.startsWith("#/")&&i.setAttribute("href","#"+n)}))},window.Planifolia.joinPaths=(...i)=>{var n="";for(const e of i)n+=e.replace(/^\/|\/$/g,"")+"/";return n.substring(0,n.length-1)},window.Planifolia.parseQuery=i=>{for(var n={},e=("?"===i[0]?i.substr(1):i).split("&"),t=0;t<e.length;t++){var o=e[t].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1]||"")}return n},window.Planifolia.replaceElementBy=(i,n)=>{let e=document.createElement(null);return e.innerHTML=n,e=e.firstChild,i.replaceWith(e),i},window.Planifolia.resolveFile=i=>{var n=window.PlanifoliaSettings.basePath,e=window.location.origin+window.location.pathname,t=window.Planifolia.joinPaths(e,n,i+".html");return window.PlanifoliaSettings.handleFileResolve(t)};